{
  "caso": {
    "id": 2,
    "titulo": "Sistema Multiagente - SupervisiÃ³n de Obra",
    "descripcion": "Sistema de agentes especializados para supervisiÃ³n automÃ¡tica de obras ferroviarias"
  },
  "layers": [
    {
      "id": 0,
      "nombre": "Problema de Negocio",
      "es_introduccion": true,
      "problema": {
        "titulo": "El DesafÃ­o de la SupervisiÃ³n de Obras Ferroviarias",
        "descripcion": "INECO supervisa obras ferroviarias complejas en mÃºltiples paÃ­ses. La supervisiÃ³n manual presenta desafÃ­os crÃ­ticos:",
        "puntos": [
          "ðŸ“· Miles de imÃ¡genes de drones diarias que revisar manualmente",
          "ðŸ‘· Inspectores en campo limitados (1 por cada 5km de obra)",
          "â° DetecciÃ³n de desviaciones tarda 2-3 dÃ­as (cuando ya hay sobrecostes)",
          "ðŸ“Š ComparaciÃ³n manual con planos y normativas (propenso a errores)",
          "ðŸ”„ Sin integraciÃ³n con gemelo digital TWINECO en tiempo real"
        ],
        "impacto": "Las desviaciones detectadas tarde generan sobrecostes del 15-20%. La falta de supervisiÃ³n continua compromete calidad y seguridad."
      },
      "solucion": {
        "titulo": "Â¿Por quÃ© un Sistema Multiagente?",
        "descripcion": "Un sistema de agentes especializados puede:",
        "beneficios": [
          "ðŸ‘ï¸ Analizar automÃ¡ticamente imÃ¡genes de drones en tiempo real",
          "âš¡ Detectar desviaciones en minutos en lugar de dÃ­as",
          "ðŸ¤– EspecializaciÃ³n: cada agente domina una tarea especÃ­fica",
          "ðŸ”— IntegraciÃ³n automÃ¡tica con TWINECO (gemelo digital)",
          "ðŸ“‹ ValidaciÃ³n contra normativas ADIF/UIC sin intervenciÃ³n humana"
        ],
        "enfoque": "Construiremos el sistema capa por capa: desde un agente Ãºnico hasta una arquitectura multiagente robusta, segura y confiable."
      }
    },
    {
      "id": 1,
      "nombre": "Sistema Base",
      "componentes": [
        {
          "tipo": "input",
          "label": "IMÃGENES DRONES",
          "descripcion": "FotografÃ­as aÃ©reas de obra",
          "ejemplo": "imagen_obra_tramo_5.jpg"
        },
        {
          "tipo": "agent",
          "label": "AGENTE ANÃLISIS",
          "descripcion": "Agente Ãºnico que hace todo",
          "ejemplo": "Tiempo: 8 segundos"
        },
        {
          "tipo": "output",
          "label": "ALERTA",
          "descripcion": "NotificaciÃ³n de desviaciÃ³n",
          "ejemplo": "DesviaciÃ³n detectada: 3cm respecto a plano"
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Detecta desviaciones automÃ¡ticamente",
          "explicacion": "El agente analiza imÃ¡genes y detecta diferencias respecto a planos: posiciÃ³n de vÃ­a, estructuras, elementos de seguridad. Automatiza trabajo manual de inspectores."
        },
        {
          "texto": "Procesa imÃ¡genes de drones",
          "explicacion": "Computer vision integrado: reconoce elementos ferroviarios (vÃ­as, traviesas, balasto, catenaria) y mide dimensiones con precisiÃ³n milimÃ©trica."
        },
        {
          "texto": "Genera alertas",
          "explicacion": "Cuando detecta una desviaciÃ³n, crea automÃ¡ticamente una alerta con ubicaciÃ³n, tipo de problema y severidad estimada."
        }
      ],
      "problemas": [
        {
          "texto": "Un solo agente hace todo (sobrecarga)",
          "explicacion": "El agente debe: analizar imagen, validar normativa, actualizar TWINECO, generar informe. Demasiadas responsabilidades â†’ lento y propenso a errores."
        },
        {
          "texto": "No valida contra normativa tÃ©cnica",
          "explicacion": "Detecta la desviaciÃ³n pero no sabe si estÃ¡ dentro de tolerancias permitidas por ADIF. Un inspector debe validar manualmente cada alerta."
        },
        {
          "texto": "No actualiza gemelo digital (TWINECO)",
          "explicacion": "La desviaciÃ³n detectada no se refleja en TWINECO. El gemelo digital queda desactualizado, perdiendo valor como fuente de verdad."
        },
        {
          "texto": "No puede acceder a herramientas peligrosas de forma controlada",
          "explicacion": "Si necesita actualizar TWINECO o enviar alertas crÃ­ticas, no hay control sobre quÃ© puede hacer. Riesgo de acciones no autorizadas."
        },
        {
          "texto": "Sin monitorizaciÃ³n de rendimiento",
          "explicacion": "No sabemos si el agente funciona correctamente: Â¿cuÃ¡ntas imÃ¡genes procesa? Â¿cuÃ¡nto tarda? Â¿cuÃ¡ntos errores tiene? Caja negra."
        },
        {
          "texto": "Sin validaciÃ³n de confianza en decisiones",
          "explicacion": "Â¿QuÃ© tan seguro estÃ¡ el agente de que hay una desviaciÃ³n? Â¿Es 50% o 99% de confianza? Sin esto, no sabemos si confiar en las alertas."
        }
      ],
      "problemas_resueltos": []
    },
    {
      "id": 2,
      "nombre": "OrquestaciÃ³n de Agentes Especializados",
      "componentes": [
        {
          "tipo": "input",
          "label": "IMÃGENES",
          "descripcion": "Input de drones"
        },
        {
          "tipo": "agent",
          "label": "COORDINADOR",
          "descripcion": "Orquesta el flujo entre agentes",
          "ejemplo": "Distribuye tareas y recopila resultados"
        },
        {
          "tipo": "agent",
          "label": "COMPUTER VISION",
          "descripcion": "Analiza imÃ¡genes",
          "ejemplo": "Tiempo: 2s - DesviaciÃ³n 3cm detectada"
        },
        {
          "tipo": "agent",
          "label": "VALIDADOR NORMATIVO",
          "descripcion": "Valida contra normas ADIF",
          "ejemplo": "Tiempo: 1s - Fuera de tolerancia"
        },
        {
          "tipo": "agent",
          "label": "GEMELO DIGITAL",
          "descripcion": "Actualiza TWINECO",
          "ejemplo": "Tiempo: 1s - Estado: ALERTA CRÃTICA"
        },
        {
          "tipo": "agent",
          "label": "GENERADOR INFORMES",
          "descripcion": "Crea documentaciÃ³n",
          "ejemplo": "Tiempo: 3s - informe_desviacion_tramo5.pdf"
        },
        {
          "tipo": "output",
          "label": "OUTPUT",
          "descripcion": "Resultado completo",
          "ejemplo": "Total tiempo: 7s (vs 8s anterior)"
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "EspecializaciÃ³n: cada agente una funciÃ³n",
          "explicacion": "Computer Vision solo analiza imÃ¡genes. Validador solo verifica normativas. Cada agente es experto en su dominio â†’ mayor precisiÃ³n y mantenibilidad."
        },
        {
          "texto": "ParalelizaciÃ³n de tareas",
          "explicacion": "Mientras Computer Vision analiza imagen 2, Validador procesa resultado de imagen 1. EjecuciÃ³n concurrente â†’ 12% mÃ¡s rÃ¡pido que agente Ãºnico."
        },
        {
          "texto": "IntegraciÃ³n con TWINECO",
          "explicacion": "Agente Gemelo Digital actualiza automÃ¡ticamente el modelo 3D con cada desviaciÃ³n detectada. TWINECO siempre refleja estado real de la obra."
        },
        {
          "texto": "ValidaciÃ³n normativa automÃ¡tica",
          "explicacion": "Agente Validador conoce todas las normativas ADIF/UIC. Verifica automÃ¡ticamente si desviaciÃ³n estÃ¡ dentro de tolerancias. Reduce falsos positivos 80%."
        },
        {
          "texto": "ComunicaciÃ³n A2A/MCP entre agentes",
          "explicacion": "Agentes se comunican mediante protocolo MCP (Model Context Protocol). Mensajes estructurados, trazables y con retry automÃ¡tico si hay fallos."
        }
      ],
      "problemas": [
        {
          "texto": "Agentes pueden ejecutar acciones peligrosas sin control",
          "explicacion": "Agente Gemelo Digital puede modificar TWINECO sin restricciones. Â¿Y si un bug hace que marque toda la obra como 'CRÃTICO'? No hay permisos granulares."
        },
        {
          "texto": "Sin mÃ©tricas de rendimiento",
          "explicacion": "No sabemos quÃ© agente es el cuello de botella. Â¿Computer Vision tarda mucho? Â¿Validador falla a menudo? Sin mÃ©tricas, no podemos optimizar."
        },
        {
          "texto": "Â¿CÃ³mo sabemos si las decisiones son correctas?",
          "explicacion": "Si Computer Vision dice 'desviaciÃ³n 3cm' y Validador dice 'crÃ­tico', Â¿cÃ³mo verificamos que es correcto? No hay validaciÃ³n cruzada ni evidencia documental."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "Resuelto: 5 agentes especializados distribuyen la carga. Cada uno domina su funciÃ³n."
        },
        {
          "texto": "No valida normativa",
          "explicacion": "Resuelto: Agente Validador Normativo verifica automÃ¡ticamente contra ADIF/UIC."
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "Resuelto: Agente Gemelo Digital sincroniza automÃ¡ticamente con TWINECO."
        }
      ]
    },
    {
      "id": 3,
      "nombre": "Tool Use Security y Entitlements",
      "componentes": [
        {
          "tipo": "input",
          "label": "IMÃGENES",
          "descripcion": "Input"
        },
        {
          "tipo": "agent",
          "label": "COORDINADOR",
          "descripcion": "Orquestador"
        },
        {
          "tipo": "security",
          "label": "POLICY ENGINE",
          "descripcion": "Controla permisos de cada agente",
          "ejemplo": "CV: âœ… READ_IMAGES âŒ WRITE_DATABASE"
        },
        {
          "tipo": "agent",
          "label": "COMPUTER VISION",
          "descripcion": "Con permisos limitados",
          "ejemplo": "Permisos: READ_IMAGES, ANALYZE_IMAGE"
        },
        {
          "tipo": "agent",
          "label": "VALIDADOR NORMATIVO",
          "descripcion": "Con permisos especÃ­ficos"
        },
        {
          "tipo": "agent",
          "label": "GEMELO DIGITAL",
          "descripcion": "Requiere aprobaciÃ³n humana",
          "ejemplo": "Human-in-the-Loop para acciones crÃ­ticas"
        },
        {
          "tipo": "agent",
          "label": "GENERADOR INFORMES",
          "descripcion": "Con permisos de escritura"
        },
        {
          "tipo": "security",
          "label": "AUDIT LOG",
          "descripcion": "Registra intentos no autorizados",
          "ejemplo": "Intento bloqueado - CV - 14:32:18"
        },
        {
          "tipo": "output",
          "label": "OUTPUT",
          "descripcion": "Resultado seguro"
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Principle of Least Privilege aplicado",
          "explicacion": "Cada agente solo tiene los permisos mÃ­nimos necesarios. Computer Vision puede leer imÃ¡genes pero no escribir en TWINECO. Reduce superficie de ataque."
        },
        {
          "texto": "Whitelisting de funciones por agente",
          "explicacion": "Lista explÃ­cita de funciones permitidas por agente. Computer Vision: [analyze_image, detect_objects]. Cualquier otra funciÃ³n â†’ bloqueada."
        },
        {
          "texto": "AprobaciÃ³n humana para acciones crÃ­ticas",
          "explicacion": "Si Agente Gemelo Digital quiere cambiar estado de infraestructura a 'SHUTDOWN', requiere aprobaciÃ³n de ingeniero senior. Human-in-the-Loop para decisiones crÃ­ticas."
        },
        {
          "texto": "AuditorÃ­a de intentos no autorizados",
          "explicacion": "Cada intento de ejecutar funciÃ³n no permitida se registra: agente, funciÃ³n, timestamp. Permite detectar comportamientos anÃ³malos o bugs."
        },
        {
          "texto": "Function Whitelist por agente",
          "explicacion": "ConfiguraciÃ³n declarativa de permisos. FÃ¡cil de auditar y modificar. Ejemplo: Validador puede [read_norms, validate_spec] pero no [write_db, send_email]."
        }
      ],
      "problemas": [
        {
          "texto": "Sin mÃ©tricas de rendimiento",
          "explicacion": "Aunque tenemos seguridad, seguimos sin saber: Â¿cuÃ¡nto tarda cada agente? Â¿cuÃ¡ntas imÃ¡genes procesa por minuto? Â¿cuÃ¡l es el accuracy?"
        },
        {
          "texto": "Â¿CÃ³mo validamos que decisiones son correctas?",
          "explicacion": "Tenemos permisos pero no validaciÃ³n de calidad. Si Computer Vision detecta mal, nadie lo verifica. Necesitamos cross-validation y confidence scoring."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "Resuelto: Policy Engine + Whitelisting + Human-in-the-Loop controlan todas las acciones."
        }
      ]
    },
    {
      "id": 4,
      "nombre": "MonitorizaciÃ³n, CalibraciÃ³n y GestiÃ³n de Errores",
      "componentes": [
        {
          "tipo": "input",
          "label": "IMÃGENES",
          "descripcion": "Input"
        },
        {
          "tipo": "agent",
          "label": "SISTEMA MULTIAGENTE",
          "descripcion": "5 agentes coordinados"
        },
        {
          "tipo": "monitoring",
          "label": "DASHBOARD TIEMPO REAL",
          "descripcion": "MÃ©tricas en vivo",
          "ejemplo": "Latencia: 4.2s | Accuracy: 98.7% | Tokens: 125,430"
        },
        {
          "tipo": "monitoring",
          "label": "LOGGING INMUTABLE",
          "descripcion": "Logs encriptados y firmados",
          "ejemplo": "Cada operaciÃ³n registrada con timestamp"
        },
        {
          "tipo": "monitoring",
          "label": "ERROR HANDLER",
          "descripcion": "Retry logic automÃ¡tico",
          "ejemplo": "Validador: 2 reintentos - API inestable"
        },
        {
          "tipo": "monitoring",
          "label": "ALERTING SYSTEM",
          "descripcion": "Notificaciones de anomalÃ­as",
          "ejemplo": "âš ï¸ Gemelo Digital lento (5.3s > 5s threshold)"
        },
        {
          "tipo": "output",
          "label": "OUTPUT + MÃ‰TRICAS",
          "descripcion": "Resultado con trazabilidad completa"
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "MonitorizaciÃ³n en tiempo real",
          "explicacion": "Dashboard muestra mÃ©tricas live: latencia por agente, throughput, errores, token usage. Detecta problemas antes de que afecten producciÃ³n."
        },
        {
          "texto": "Logging inmutable para auditorÃ­a",
          "explicacion": "Cada operaciÃ³n genera log firmado criptogrÃ¡ficamente. No se puede modificar ni borrar. Cumple requisitos de auditorÃ­a y compliance."
        },
        {
          "texto": "Manejo automÃ¡tico de errores",
          "explicacion": "Si un agente falla (timeout, API error), el sistema reintenta automÃ¡ticamente con backoff exponencial. 3 intentos antes de escalar a humano."
        },
        {
          "texto": "Alertas por anomalÃ­as",
          "explicacion": "Sistema detecta comportamientos anÃ³malos: agente muy lento, accuracy bajando, errores aumentando. Alerta a equipo de ops automÃ¡ticamente."
        },
        {
          "texto": "MÃ©tricas de rendimiento por agente",
          "explicacion": "Desglose detallado: Computer Vision 2.1s avg, Validador 0.8s, Gemelo Digital 5.3s. Identifica cuellos de botella para optimizaciÃ³n."
        },
        {
          "texto": "Dashboard de operaciones",
          "explicacion": "Panel centralizado para equipo de ops: estado de agentes, cola de procesamiento, historial de errores, mÃ©tricas de negocio (desviaciones detectadas/hora)."
        }
      ],
      "problemas": [
        {
          "texto": "Â¿CÃ³mo validamos que las decisiones son correctas?",
          "explicacion": "Tenemos mÃ©tricas de rendimiento pero no de calidad. Si Computer Vision dice 'desviaciÃ³n 3cm', Â¿cÃ³mo sabemos que es correcto? Falta validaciÃ³n de evidencia."
        },
        {
          "texto": "Â¿QuÃ© confianza tenemos en cada resultado?",
          "explicacion": "No hay confidence scoring. Una detecciÃ³n con 60% de confianza se trata igual que una con 99%. Necesitamos cuantificar incertidumbre."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "âœ… Resuelto en Layer 3"
        },
        {
          "texto": "Sin mÃ©tricas de rendimiento",
          "explicacion": "Resuelto: Dashboard en tiempo real + logging inmutable + alerting system."
        }
      ]
    },
    {
      "id": 5,
      "nombre": "Validadores y Grounding",
      "componentes": [
        {
          "tipo": "input",
          "label": "IMÃGENES",
          "descripcion": "Input"
        },
        {
          "tipo": "agent",
          "label": "SISTEMA MULTIAGENTE",
          "descripcion": "Agentes especializados"
        },
        {
          "tipo": "validation",
          "label": "GROUNDING ENGINE",
          "descripcion": "Verifica evidencia documental",
          "ejemplo": "100% afirmaciones con evidencia"
        },
        {
          "tipo": "validation",
          "label": "CROSS-VALIDATOR",
          "descripcion": "ValidaciÃ³n cruzada entre agentes",
          "ejemplo": "Confidence ajustado: 0.94 â†’ 0.91"
        },
        {
          "tipo": "validation",
          "label": "CONFIDENCE SCORING",
          "descripcion": "PuntuaciÃ³n de confianza",
          "ejemplo": "Score > 0.85 â†’ Auto-approve"
        },
        {
          "tipo": "validation",
          "label": "CITATION SYSTEM",
          "descripcion": "Referencias trazables",
          "ejemplo": "DesviaciÃ³n 3cm [1][2] excede tolerancia [2]"
        },
        {
          "tipo": "validation",
          "label": "HUMAN REVIEW",
          "descripcion": "RevisiÃ³n humana si confidence < 0.85",
          "ejemplo": "Confidence 0.72 â†’ Requiere validaciÃ³n"
        },
        {
          "tipo": "monitoring",
          "label": "MONITORING",
          "descripcion": "Dashboard completo"
        },
        {
          "tipo": "output",
          "label": "OUTPUT VALIDADO",
          "descripcion": "Resultado con evidencias y confianza"
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Grounding: toda afirmaciÃ³n con evidencia documental",
          "explicacion": "Cada detecciÃ³n estÃ¡ respaldada por evidencia: imagen analizada, mediciÃ³n DIGAV, estado previo TWINECO. No hay afirmaciones sin fundamento."
        },
        {
          "texto": "Cross-validation entre agentes",
          "explicacion": "Computer Vision detecta desviaciÃ³n (confidence 0.94). Cross-Validator revisa evidencia, correlaciona con alertas previas, ajusta confidence a 0.91. Reduce falsos positivos."
        },
        {
          "texto": "Confidence scoring para decisiones",
          "explicacion": "Cada resultado tiene score 0-1. >0.85 â†’ auto-aprobado. 0.70-0.85 â†’ revisiÃ³n opcional. <0.70 â†’ requiere humano. Decisiones basadas en certeza."
        },
        {
          "texto": "Citations completas y trazables",
          "explicacion": "Output incluye referencias: 'DesviaciÃ³n 3cm [1][2] excede tolerancia 2cm [3]'. [1]=imagen, [2]=mediciÃ³n DIGAV, [3]=norma ADIF. Trazabilidad total."
        },
        {
          "texto": "Human-in-the-loop para baja confianza",
          "explicacion": "Si confidence < 0.85, ingeniero senior recibe notificaciÃ³n con contexto completo. Puede aprobar, rechazar o solicitar mÃ¡s informaciÃ³n."
        },
        {
          "texto": "Sistema robusto y confiable",
          "explicacion": "CombinaciÃ³n de especializaciÃ³n, seguridad, monitorizaciÃ³n y validaciÃ³n. Sistema empresarial production-ready con SLA 99.9%."
        }
      ],
      "problemas": [],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "âœ… Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "âœ… Resuelto en Layer 3"
        },
        {
          "texto": "Sin mÃ©tricas de rendimiento",
          "explicacion": "âœ… Resuelto en Layer 4"
        },
        {
          "texto": "ValidaciÃ³n de decisiones",
          "explicacion": "Resuelto: Grounding Engine + Cross-Validator verifican cada decisiÃ³n con evidencia."
        },
        {
          "texto": "Nivel de confianza en resultados",
          "explicacion": "Resuelto: Confidence Scoring cuantifica certeza. Human review para casos de baja confianza."
        }
      ]
    }
  ]
}
