{
  "caso": {
    "id": 2,
    "titulo": "Sistema Multiagente - Supervisi√≥n de Obra",
    "descripcion": "Sistema de agentes especializados para supervisi√≥n autom√°tica de obras ferroviarias"
  },
  "layers": [
    {
      "id": 0,
      "nombre": "Problema de Negocio",
      "es_introduccion": true,
      "problema": {
        "titulo": "El Desaf√≠o de la Supervisi√≥n de Obras Ferroviarias",
        "descripcion": "INECO supervisa obras ferroviarias complejas en m√∫ltiples pa√≠ses. La supervisi√≥n manual presenta desaf√≠os cr√≠ticos:",
        "puntos": [
          "üì∑ Miles de im√°genes de drones diarias que revisar manualmente",
          "üë∑ Inspectores en campo limitados (1 por cada 5km de obra)",
          "‚è∞ Detecci√≥n de desviaciones tarda 2-3 d√≠as (cuando ya hay sobrecostes)",
          "üìä Comparaci√≥n manual con planos y normativas (propenso a errores)",
          "üîÑ Sin integraci√≥n con gemelo digital TWINECO en tiempo real"
        ],
        "impacto": "Las desviaciones detectadas tarde generan sobrecostes del 15-20%. La falta de supervisi√≥n continua compromete calidad y seguridad."
      },
      "solucion": {
        "titulo": "¬øPor qu√© un Sistema Multiagente?",
        "descripcion": "Un sistema de agentes especializados puede:",
        "beneficios": [
          "üëÅÔ∏è Analizar autom√°ticamente im√°genes de drones en tiempo real",
          "‚ö° Detectar desviaciones en minutos en lugar de d√≠as",
          "ü§ñ Especializaci√≥n: cada agente domina una tarea espec√≠fica",
          "üîó Integraci√≥n autom√°tica con TWINECO (gemelo digital)",
          "üìã Validaci√≥n contra normativas ADIF/UIC sin intervenci√≥n humana"
        ],
        "enfoque": "Construiremos el sistema capa por capa: desde un agente √∫nico hasta una arquitectura multiagente robusta, segura y confiable."
      }
    },
    {
      "id": 1,
      "nombre": "Sistema Base",
      "componentes": [
        {
          "tipo": "input",
          "label": "IM√ÅGENES DRONES",
          "descripcion": "Fotograf√≠as a√©reas de obra",
          "ejemplo": "imagen_obra_tramo_5.jpg",
          "input_value": "imagen_obra_tramo_5.jpg\n\n[Metadata: Fecha: 2025-10-15 | Tramo: 5 | KM: 23.4 | Drone: DJI-M300 | Resoluci√≥n: 4K]",
          "es_interactivo": true
        },
        {
          "tipo": "agent",
          "label": "AGENTE AN√ÅLISIS",
          "descripcion": "Agente √∫nico que hace todo",
          "ejemplo": "Tiempo: 8 segundos",
          "configuracion": {
            "modelo": "GPT-4-Vision",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en an√°lisis de im√°genes de obras ferroviarias. Analiza la imagen, detecta elementos, compara con planos y genera alertas de desviaciones."
        },
        {
          "tipo": "output",
          "label": "ALERTA",
          "descripcion": "Notificaci√≥n de desviaci√≥n",
          "ejemplo": "Desviaci√≥n detectada: 3cm respecto a plano",
          "output_completo": {
            "titulo": "ALERTA DE DESVIACI√ìN DETECTADA",
            "contenido": "AN√ÅLISIS DE IMAGEN: imagen_obra_tramo_5.jpg\nFECHA: 2025-10-15 10:23:45\nTRAMO: 5 | KM: 23.4\n\n=== DESVIACI√ìN DETECTADA ===\n\nTIPO: Posicionamiento de v√≠a\nSEVERIDAD: Media\nDESCRIPCI√ìN: La v√≠a presenta una desviaci√≥n lateral de 3.2cm respecto a la posici√≥n especificada en planos.\n\nUBICACI√ìN EXACTA: KM 23.4 + 15m\nELEMENTO AFECTADO: V√≠a principal\nTOLERANCIA PERMITIDA: ¬±2cm\nDESVIACI√ìN MEDIDA: 3.2cm\n\nACCI√ìN RECOMENDADA: Correcci√≥n mediante ajuste de traviesas\nPRIORIDAD: Media\nTIEMPO ESTIMADO CORRECCI√ìN: 2 horas",
            "metadata": {
              "fecha_analisis": "2025-10-15",
              "tiempo_procesamiento": "8.3s",
              "confianza": 0.87,
              "elementos_detectados": 15
            }
          }
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Detecta desviaciones autom√°ticamente",
          "explicacion": "El agente analiza im√°genes y detecta diferencias respecto a planos: posici√≥n de v√≠a, estructuras, elementos de seguridad. Automatiza trabajo manual de inspectores."
        },
        {
          "texto": "Procesa im√°genes de drones",
          "explicacion": "Computer vision integrado: reconoce elementos ferroviarios (v√≠as, traviesas, balasto, catenaria) y mide dimensiones con precisi√≥n milim√©trica."
        },
        {
          "texto": "Genera alertas",
          "explicacion": "Cuando detecta una desviaci√≥n, crea autom√°ticamente una alerta con ubicaci√≥n, tipo de problema y severidad estimada."
        }
      ],
      "problemas": [
        {
          "texto": "Un solo agente hace todo (sobrecarga)",
          "explicacion": "El agente debe: analizar imagen, validar normativa, actualizar TWINECO, generar informe. Demasiadas responsabilidades ‚Üí lento y propenso a errores."
        },
        {
          "texto": "No valida contra normativa t√©cnica",
          "explicacion": "Detecta la desviaci√≥n pero no sabe si est√° dentro de tolerancias permitidas por ADIF. Un inspector debe validar manualmente cada alerta."
        },
        {
          "texto": "No actualiza gemelo digital (TWINECO)",
          "explicacion": "La desviaci√≥n detectada no se refleja en TWINECO. El gemelo digital queda desactualizado, perdiendo valor como fuente de verdad."
        },
        {
          "texto": "No puede acceder a herramientas peligrosas de forma controlada",
          "explicacion": "Si necesita actualizar TWINECO o enviar alertas cr√≠ticas, no hay control sobre qu√© puede hacer. Riesgo de acciones no autorizadas."
        },
        {
          "texto": "Sin monitorizaci√≥n de rendimiento",
          "explicacion": "No sabemos si el agente funciona correctamente: ¬øcu√°ntas im√°genes procesa? ¬øcu√°nto tarda? ¬øcu√°ntos errores tiene? Caja negra."
        },
        {
          "texto": "Sin validaci√≥n de confianza en decisiones",
          "explicacion": "¬øQu√© tan seguro est√° el agente de que hay una desviaci√≥n? ¬øEs 50% o 99% de confianza? Sin esto, no sabemos si confiar en las alertas."
        }
      ],
      "problemas_resueltos": []
    },
    {
      "id": 2,
      "nombre": "Orquestaci√≥n de Agentes Especializados",
      "componentes": [
        {
          "tipo": "input",
          "label": "IM√ÅGENES",
          "descripcion": "Input de drones",
          "input_value": "imagen_obra_tramo_5.jpg\n\n[Metadata: Fecha: 2025-10-15 | Tramo: 5 | KM: 23.4 | Drone: DJI-M300 | Resoluci√≥n: 4K | Elementos visibles: V√≠a, balasto, traviesas, se√±alizaci√≥n]",
          "es_interactivo": true
        },
        {
          "tipo": "agent",
          "label": "COORDINADOR",
          "descripcion": "Orquesta el flujo entre agentes",
          "ejemplo": "Distribuye tareas y recopila resultados",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres el agente coordinador de un sistema multiagente. Recibes im√°genes, determinas qu√© agentes especializados deben procesarlas, orquestas su ejecuci√≥n y consolidas resultados."
        },
        {
          "tipo": "agent",
          "label": "COMPUTER VISION",
          "descripcion": "Analiza im√°genes",
          "ejemplo": "Tiempo: 2s - Desviaci√≥n 3cm detectada",
          "configuracion": {
            "modelo": "GPT-4-Vision",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en visi√≥n por computadora para infraestructura ferroviaria. Detecta y mide: v√≠as, traviesas, balasto, catenaria, se√±alizaci√≥n, estructuras. Proporciona mediciones precisas."
        },
        {
          "tipo": "agent",
          "label": "VALIDADOR NORMATIVO",
          "descripcion": "Valida contra normas ADIF",
          "ejemplo": "Tiempo: 1s - Fuera de tolerancia",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en normativas ferroviarias (ADIF, UIC, EN). Validas que las mediciones cumplan con especificaciones t√©cnicas y generas alertas de incumplimientos."
        },
        {
          "tipo": "agent",
          "label": "GEMELO DIGITAL",
          "descripcion": "Actualiza TWINECO",
          "ejemplo": "Tiempo: 1s - Estado: ALERTA CR√çTICA",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente que integra con TWINECO (gemelo digital). Actualizas el modelo 3D con datos reales de obra y detectas desviaciones respecto al dise√±o."
        },
        {
          "tipo": "agent",
          "label": "GENERADOR INFORMES",
          "descripcion": "Crea documentaci√≥n",
          "ejemplo": "Tiempo: 3s - informe_desviacion_tramo5.pdf",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en generar informes t√©cnicos. Consolidas informaci√≥n de otros agentes y produces informes estructurados para supervisores."
        },
        {
          "tipo": "output",
          "label": "OUTPUT",
          "descripcion": "Resultado completo",
          "ejemplo": "Total tiempo: 7s (vs 8s anterior)",
          "output_completo": {
            "titulo": "INFORME DE SUPERVISI√ìN MULTIAGENTE",
            "contenido": "AN√ÅLISIS COORDINADO: imagen_obra_tramo_5.jpg\nFECHA: 2025-10-15 10:25:12\nTRAMO: 5 | KM: 23.4\n\n=== AN√ÅLISIS POR AGENTE ESPECIALIZADO ===\n\n[COMPUTER VISION]\nElementos detectados:\n- V√≠a principal: Posici√≥n correcta\n- Traviesas: 24 unidades visibles, espaciado correcto\n- Balasto: Granulometr√≠a adecuada, nivel correcto\n- Se√±alizaci√≥n: Poste KM 23 visible y correcto\n\nMediciones:\n- Ancho de v√≠a: 1.435mm (‚úì Correcto)\n- Espaciado traviesas: 60cm (‚úì Correcto)\n- Altura balasto: 35cm (‚úì Correcto)\n\n[VALIDADOR NORMATIVO]\nValidaci√≥n contra ADIF ET 03.360.571.8:\n‚úì Ancho de v√≠a conforme\n‚úì Espaciado traviesas conforme\n‚úì Granulometr√≠a balasto conforme\n‚ö†Ô∏è ALERTA: Falta se√±alizaci√≥n de seguridad cada 50m (detectada solo en KM 23)\n\n[GEMELO DIGITAL - TWINECO]\nComparaci√≥n con modelo 3D:\n‚úì Posici√≥n v√≠a: Desviaci√≥n 0.8cm (dentro de tolerancia)\n‚úì Elevaci√≥n: Correcta\n‚ö†Ô∏è ALERTA: Estructura temporal no reflejada en gemelo digital\n\n[GENERADOR INFORMES]\n=== RESUMEN EJECUTIVO ===\nEstado general: ACEPTABLE CON OBSERVACIONES\nDesviaciones cr√≠ticas: 0\nDesviaciones medias: 2\nAcciones requeridas: 2\n\nPr√≥ximos pasos:\n1. Instalar se√±alizaci√≥n de seguridad adicional\n2. Actualizar gemelo digital con estructura temporal",
            "metadata": {
              "fecha_analisis": "2025-10-15",
              "tiempo_procesamiento": "12.7s",
              "agentes_ejecutados": 4,
              "confianza_promedio": 0.91
            }
          }
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Especializaci√≥n: cada agente una funci√≥n",
          "explicacion": "Computer Vision solo analiza im√°genes. Validador solo verifica normativas. Cada agente es experto en su dominio ‚Üí mayor precisi√≥n y mantenibilidad."
        },
        {
          "texto": "Paralelizaci√≥n de tareas",
          "explicacion": "Mientras Computer Vision analiza imagen 2, Validador procesa resultado de imagen 1. Ejecuci√≥n concurrente ‚Üí 12% m√°s r√°pido que agente √∫nico."
        },
        {
          "texto": "Integraci√≥n con TWINECO",
          "explicacion": "Agente Gemelo Digital actualiza autom√°ticamente el modelo 3D con cada desviaci√≥n detectada. TWINECO siempre refleja estado real de la obra."
        },
        {
          "texto": "Validaci√≥n normativa autom√°tica",
          "explicacion": "Agente Validador conoce todas las normativas ADIF/UIC. Verifica autom√°ticamente si desviaci√≥n est√° dentro de tolerancias. Reduce falsos positivos 80%."
        },
        {
          "texto": "Comunicaci√≥n A2A/MCP entre agentes",
          "explicacion": "Agentes se comunican mediante protocolo MCP (Model Context Protocol). Mensajes estructurados, trazables y con retry autom√°tico si hay fallos."
        }
      ],
      "problemas": [
        {
          "texto": "Agentes pueden ejecutar acciones peligrosas sin control",
          "explicacion": "Agente Gemelo Digital puede modificar TWINECO sin restricciones. ¬øY si un bug hace que marque toda la obra como 'CR√çTICO'? No hay permisos granulares."
        },
        {
          "texto": "Sin m√©tricas de rendimiento",
          "explicacion": "No sabemos qu√© agente es el cuello de botella. ¬øComputer Vision tarda mucho? ¬øValidador falla a menudo? Sin m√©tricas, no podemos optimizar."
        },
        {
          "texto": "¬øC√≥mo sabemos si las decisiones son correctas?",
          "explicacion": "Si Computer Vision dice 'desviaci√≥n 3cm' y Validador dice 'cr√≠tico', ¬øc√≥mo verificamos que es correcto? No hay validaci√≥n cruzada ni evidencia documental."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "Resuelto: 5 agentes especializados distribuyen la carga. Cada uno domina su funci√≥n."
        },
        {
          "texto": "No valida normativa",
          "explicacion": "Resuelto: Agente Validador Normativo verifica autom√°ticamente contra ADIF/UIC."
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "Resuelto: Agente Gemelo Digital sincroniza autom√°ticamente con TWINECO."
        }
      ]
    },
    {
      "id": 3,
      "nombre": "Tool Use Security y Entitlements",
      "componentes": [
        {
          "tipo": "input",
          "label": "IM√ÅGENES",
          "descripcion": "Input",
          "input_value": "imagen_obra_tramo_5.jpg\n\n[Metadata: Fecha: 2025-10-15 | Tramo: 5 | KM: 23.4 | Drone: DJI-M300 | Resoluci√≥n: 4K | Usuario: inspector.campo@empresa.com | Proyecto: OBRA-2025-089 | Clearance: Interno]",
          "es_interactivo": true
        },
        {
          "tipo": "agent",
          "label": "COORDINADOR",
          "descripcion": "Orquestador",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres el agente coordinador de un sistema multiagente. Recibes im√°genes, determinas qu√© agentes especializados deben procesarlas, orquestas su ejecuci√≥n y consolidas resultados."
        },
        {
          "tipo": "security",
          "label": "POLICY ENGINE",
          "descripcion": "Controla permisos de cada agente",
          "ejemplo": "CV: ‚úÖ READ_IMAGES ‚ùå WRITE_DATABASE"
        },
        {
          "tipo": "agent",
          "label": "COMPUTER VISION",
          "descripcion": "Con permisos limitados",
          "ejemplo": "Permisos: READ_IMAGES, ANALYZE_IMAGE",
          "configuracion": {
            "modelo": "GPT-4-Vision",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en visi√≥n por computadora para infraestructura ferroviaria. Detecta y mide: v√≠as, traviesas, balasto, catenaria, se√±alizaci√≥n, estructuras. Proporciona mediciones precisas."
        },
        {
          "tipo": "agent",
          "label": "VALIDADOR NORMATIVO",
          "descripcion": "Con permisos espec√≠ficos",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en normativas ferroviarias (ADIF, UIC, EN). Validas que las mediciones cumplan con especificaciones t√©cnicas y generas alertas de incumplimientos."
        },
        {
          "tipo": "agent",
          "label": "GEMELO DIGITAL",
          "descripcion": "Requiere aprobaci√≥n humana",
          "ejemplo": "Human-in-the-Loop para acciones cr√≠ticas",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente que integra con TWINECO (gemelo digital). Actualizas el modelo 3D con datos reales de obra y detectas desviaciones respecto al dise√±o."
        },
        {
          "tipo": "agent",
          "label": "GENERADOR INFORMES",
          "descripcion": "Con permisos de escritura",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres un agente especializado en generar informes t√©cnicos. Consolidas informaci√≥n de otros agentes y produces informes estructurados para supervisores."
        },
        {
          "tipo": "security",
          "label": "AUDIT LOG",
          "descripcion": "Registra intentos no autorizados",
          "ejemplo": "Intento bloqueado - CV - 14:32:18"
        },
        {
          "tipo": "output",
          "label": "OUTPUT",
          "descripcion": "Resultado seguro",
          "output_completo": {
            "titulo": "INFORME DE SUPERVISI√ìN SEGURO",
            "contenido": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nCLASIFICACI√ìN: INTERNO\nPROYECTO: OBRA-2025-089\nANALIZADO POR: inspector.campo@empresa.com\nFECHA: 2025-10-15 10:27:33 UTC\nAUDIT ID: AUDIT-2025-10-15-102733\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nAN√ÅLISIS COORDINADO: imagen_obra_tramo_5.jpg\nTRAMO: 5 | KM: 23.4\n\n[COMPUTER VISION - Autorizado]\nElementos detectados: 15\nMediciones realizadas: 8\nConfianza: 0.92\n\n[VALIDADOR NORMATIVO - Autorizado]\nNormativas consultadas: ADIF ET 03.360.571.8, UIC 719\nValidaciones: 12 conformes, 2 alertas\n\n[GEMELO DIGITAL - Acceso restringido aplicado]\nActualizaci√≥n TWINECO: Completada\nDesviaciones: 1 menor\n\n[GENERADOR INFORMES]\nEstado: ACEPTABLE CON OBSERVACIONES\nAcciones requeridas: 2\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nCLASIFICACI√ìN: INTERNO\nDistribuci√≥n: Personal autorizado proyecto OBRA-2025-089\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
            "metadata": {
              "fecha_analisis": "2025-10-15",
              "tiempo_procesamiento": "13.4s",
              "usuario": "inspector.campo@empresa.com",
              "proyecto": "OBRA-2025-089",
              "classification_level": "Interno",
              "tools_used": [
                "computer_vision",
                "normativas_db",
                "twineco_api"
              ],
              "audit_log_id": "AUDIT-2025-10-15-102733"
            }
          }
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Principle of Least Privilege aplicado",
          "explicacion": "Cada agente solo tiene los permisos m√≠nimos necesarios. Computer Vision puede leer im√°genes pero no escribir en TWINECO. Reduce superficie de ataque."
        },
        {
          "texto": "Whitelisting de funciones por agente",
          "explicacion": "Lista expl√≠cita de funciones permitidas por agente. Computer Vision: [analyze_image, detect_objects]. Cualquier otra funci√≥n ‚Üí bloqueada."
        },
        {
          "texto": "Aprobaci√≥n humana para acciones cr√≠ticas",
          "explicacion": "Si Agente Gemelo Digital quiere cambiar estado de infraestructura a 'SHUTDOWN', requiere aprobaci√≥n de ingeniero senior. Human-in-the-Loop para decisiones cr√≠ticas."
        },
        {
          "texto": "Auditor√≠a de intentos no autorizados",
          "explicacion": "Cada intento de ejecutar funci√≥n no permitida se registra: agente, funci√≥n, timestamp. Permite detectar comportamientos an√≥malos o bugs."
        },
        {
          "texto": "Function Whitelist por agente",
          "explicacion": "Configuraci√≥n declarativa de permisos. F√°cil de auditar y modificar. Ejemplo: Validador puede [read_norms, validate_spec] pero no [write_db, send_email]."
        }
      ],
      "problemas": [
        {
          "texto": "Sin m√©tricas de rendimiento",
          "explicacion": "Aunque tenemos seguridad, seguimos sin saber: ¬øcu√°nto tarda cada agente? ¬øcu√°ntas im√°genes procesa por minuto? ¬øcu√°l es el accuracy?"
        },
        {
          "texto": "¬øC√≥mo validamos que decisiones son correctas?",
          "explicacion": "Tenemos permisos pero no validaci√≥n de calidad. Si Computer Vision detecta mal, nadie lo verifica. Necesitamos cross-validation y confidence scoring."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "Resuelto: Policy Engine + Whitelisting + Human-in-the-Loop controlan todas las acciones."
        }
      ]
    },
    {
      "id": 4,
      "nombre": "Monitorizaci√≥n, Calibraci√≥n y Gesti√≥n de Errores",
      "componentes": [
        {
          "tipo": "input",
          "label": "IM√ÅGENES",
          "descripcion": "Input",
          "input_value": "imagen_obra_tramo_5.jpg\n\n[Metadata: Fecha: 2025-10-15 | Tramo: 5 | KM: 23.4 | Drone: DJI-M300 | Resoluci√≥n: 4K | Usuario: inspector.campo@empresa.com | Proyecto: OBRA-2025-089 | Criticidad: Alta | Budget_Tramo: 12M‚Ç¨]",
          "es_interactivo": true
        },
        {
          "tipo": "agent",
          "label": "SISTEMA MULTIAGENTE",
          "descripcion": "5 agentes coordinados",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres el sistema coordinador de m√∫ltiples agentes especializados en supervisi√≥n de obras ferroviarias. Orquestas an√°lisis de im√°genes, validaci√≥n normativa, actualizaci√≥n de gemelo digital y generaci√≥n de informes."
        },
        {
          "tipo": "monitoring",
          "label": "DASHBOARD TIEMPO REAL",
          "descripcion": "M√©tricas en vivo",
          "ejemplo": "Latencia: 4.2s | Accuracy: 98.7% | Tokens: 125,430"
        },
        {
          "tipo": "monitoring",
          "label": "LOGGING INMUTABLE",
          "descripcion": "Logs encriptados y firmados",
          "ejemplo": "Cada operaci√≥n registrada con timestamp"
        },
        {
          "tipo": "monitoring",
          "label": "ERROR HANDLER",
          "descripcion": "Retry logic autom√°tico",
          "ejemplo": "Validador: 2 reintentos - API inestable"
        },
        {
          "tipo": "monitoring",
          "label": "ALERTING SYSTEM",
          "descripcion": "Notificaciones de anomal√≠as",
          "ejemplo": "‚ö†Ô∏è Gemelo Digital lento (5.3s > 5s threshold)"
        },
        {
          "tipo": "output",
          "label": "OUTPUT + M√âTRICAS",
          "descripcion": "Resultado con trazabilidad completa",
          "output_completo": {
            "titulo": "INFORME DE SUPERVISI√ìN CON MONITORIZACI√ìN",
            "contenido": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nCLASIFICACI√ìN: INTERNO\nPROYECTO: OBRA-2025-089 | TRAMO: 5 | KM: 23.4\nANALIZADO POR: inspector.campo@empresa.com\nFECHA: 2025-10-15 10:29:18 UTC\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nAN√ÅLISIS MULTIAGENTE: imagen_obra_tramo_5.jpg\n\n[M√âTRICAS DE SISTEMA]\nTiempo total: 13.2s\nAgentes ejecutados: 4/4 (100% √©xito)\nConfianza promedio: 0.91\nErrores: 0\n\n[RESULTADOS]\nEstado general: ACEPTABLE CON OBSERVACIONES\nDesviaciones cr√≠ticas: 0\nDesviaciones medias: 2\nAcciones requeridas: 2\n\n[VALIDACIONES]\n‚úì Computer Vision: 15 elementos detectados\n‚úì Normativas: 12/14 conformes\n‚úì Gemelo Digital: Actualizado\n‚ö†Ô∏è Se√±alizaci√≥n: Falta 1 poste\n‚ö†Ô∏è Estructura temporal: No en gemelo\n\n[MONITORIZACI√ìN]\nRendimiento agentes:\n- Computer Vision: 4.2s (Normal)\n- Validador: 3.1s (Normal)\n- Gemelo Digital: 4.8s (Normal)\n- Generador: 1.1s (Normal)\n\nConfianza por agente:\n- Computer Vision: 0.92\n- Validador: 0.89\n- Gemelo Digital: 0.94\n- Generador: 0.90\n\n[ACCIONES REQUERIDAS]\n1. Instalar se√±alizaci√≥n KM 23.5\n2. Actualizar gemelo con estructura temporal\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
            "metadata": {
              "fecha_analisis": "2025-10-15",
              "tiempo_procesamiento": "13.2s",
              "classification_level": "Interno",
              "metricas_sistema": {
                "agentes_exitosos": 4,
                "agentes_fallidos": 0,
                "tiempo_promedio_agente": "3.3s",
                "confianza_minima": 0.89,
                "confianza_promedio": 0.91
              }
            }
          }
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Monitorizaci√≥n en tiempo real",
          "explicacion": "Dashboard muestra m√©tricas live: latencia por agente, throughput, errores, token usage. Detecta problemas antes de que afecten producci√≥n."
        },
        {
          "texto": "Logging inmutable para auditor√≠a",
          "explicacion": "Cada operaci√≥n genera log firmado criptogr√°ficamente. No se puede modificar ni borrar. Cumple requisitos de auditor√≠a y compliance."
        },
        {
          "texto": "Manejo autom√°tico de errores",
          "explicacion": "Si un agente falla (timeout, API error), el sistema reintenta autom√°ticamente con backoff exponencial. 3 intentos antes de escalar a humano."
        },
        {
          "texto": "Alertas por anomal√≠as",
          "explicacion": "Sistema detecta comportamientos an√≥malos: agente muy lento, accuracy bajando, errores aumentando. Alerta a equipo de ops autom√°ticamente."
        },
        {
          "texto": "M√©tricas de rendimiento por agente",
          "explicacion": "Desglose detallado: Computer Vision 2.1s avg, Validador 0.8s, Gemelo Digital 5.3s. Identifica cuellos de botella para optimizaci√≥n."
        },
        {
          "texto": "Dashboard de operaciones",
          "explicacion": "Panel centralizado para equipo de ops: estado de agentes, cola de procesamiento, historial de errores, m√©tricas de negocio (desviaciones detectadas/hora)."
        }
      ],
      "problemas": [
        {
          "texto": "¬øC√≥mo validamos que las decisiones son correctas?",
          "explicacion": "Tenemos m√©tricas de rendimiento pero no de calidad. Si Computer Vision dice 'desviaci√≥n 3cm', ¬øc√≥mo sabemos que es correcto? Falta validaci√≥n de evidencia."
        },
        {
          "texto": "¬øQu√© confianza tenemos en cada resultado?",
          "explicacion": "No hay confidence scoring. Una detecci√≥n con 60% de confianza se trata igual que una con 99%. Necesitamos cuantificar incertidumbre."
        }
      ],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "‚úÖ Resuelto en Layer 3"
        },
        {
          "texto": "Sin m√©tricas de rendimiento",
          "explicacion": "Resuelto: Dashboard en tiempo real + logging inmutable + alerting system."
        }
      ]
    },
    {
      "id": 5,
      "nombre": "Validadores y Grounding",
      "componentes": [
        {
          "tipo": "input",
          "label": "IM√ÅGENES",
          "descripcion": "Input",
          "input_value": "imagen_obra_tramo_5.jpg\n\n[Metadata: Fecha: 2025-10-15 | Tramo: 5 | KM: 23.4 | Drone: DJI-M300 | Resoluci√≥n: 4K | Usuario: inspector.campo@empresa.com | Proyecto: OBRA-2025-089 | Criticidad: Alta | Budget_Tramo: 12M‚Ç¨ | Safety_Critical: Yes]",
          "es_interactivo": true
        },
        {
          "tipo": "agent",
          "label": "SISTEMA MULTIAGENTE",
          "descripcion": "Agentes especializados",
          "configuracion": {
            "modelo": "GPT-4",
            "temperatura": 0.1,
            "max_tokens": 2000,
            "top_p": 0.95,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.0
          },
          "system_prompt": "Eres el sistema coordinador de m√∫ltiples agentes especializados en supervisi√≥n de obras ferroviarias. Orquestas an√°lisis de im√°genes, validaci√≥n normativa, actualizaci√≥n de gemelo digital y generaci√≥n de informes."
        },
        {
          "tipo": "validation",
          "label": "GROUNDING ENGINE",
          "descripcion": "Verifica evidencia documental",
          "ejemplo": "100% afirmaciones con evidencia"
        },
        {
          "tipo": "validation",
          "label": "CROSS-VALIDATOR",
          "descripcion": "Validaci√≥n cruzada entre agentes",
          "ejemplo": "Confidence ajustado: 0.94 ‚Üí 0.91"
        },
        {
          "tipo": "validation",
          "label": "CONFIDENCE SCORING",
          "descripcion": "Puntuaci√≥n de confianza",
          "ejemplo": "Score > 0.85 ‚Üí Auto-approve"
        },
        {
          "tipo": "validation",
          "label": "CITATION SYSTEM",
          "descripcion": "Referencias trazables",
          "ejemplo": "Desviaci√≥n 3cm [1][2] excede tolerancia [2]"
        },
        {
          "tipo": "validation",
          "label": "HUMAN REVIEW",
          "descripcion": "Revisi√≥n humana si confidence < 0.85",
          "ejemplo": "Confidence 0.72 ‚Üí Requiere validaci√≥n"
        },
        {
          "tipo": "monitoring",
          "label": "MONITORING",
          "descripcion": "Dashboard completo"
        },
        {
          "tipo": "output",
          "label": "OUTPUT VALIDADO",
          "descripcion": "Resultado con evidencias y confianza",
          "output_completo": {
            "titulo": "INFORME DE SUPERVISI√ìN VALIDADO",
            "contenido": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nCLASIFICACI√ìN: INTERNO\nPROYECTO: OBRA-2025-089 | TRAMO: 5 | KM: 23.4\nANALIZADO POR: inspector.campo@empresa.com\nVALIDADO POR: supervisor.senior@empresa.com\nFECHA AN√ÅLISIS: 2025-10-15 10:29:18 UTC\nFECHA VALIDACI√ìN: 2025-10-15 10:45:22 UTC\nSTATUS: APROBADO\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nAN√ÅLISIS MULTIAGENTE: imagen_obra_tramo_5.jpg\n\n[VALIDACI√ìN AUTOM√ÅTICA]\n‚úì Grounding: Todas las afirmaciones respaldadas por evidencia\n‚úì Cross-Validation: Mediciones verificadas por m√∫ltiples agentes\n‚úì Confidence Scoring: Todas las detecciones >0.85\n‚úì Citations: Todas las normativas citadas correctamente\n\n[RESULTADOS VALIDADOS]\nEstado general: ACEPTABLE CON OBSERVACIONES\nDesviaciones cr√≠ticas: 0 (Validado)\nDesviaciones medias: 2 (Validado)\nConfianza global: 0.91 (Alto)\n\n[DETECCIONES PRINCIPALES]\n‚úì V√≠a: Posici√≥n correcta (Confianza: 0.94)\n  Evidencia: Medici√≥n l√°ser + comparaci√≥n gemelo digital\n  Validado por: Computer Vision + Gemelo Digital\n  \n‚úì Traviesas: 24 unidades, espaciado 60cm (Confianza: 0.92)\n  Evidencia: Detecci√≥n visual + medici√≥n calibrada\n  Normativa: ADIF ET 03.360.571.8 [Citado correctamente]\n  \n‚ö†Ô∏è Se√±alizaci√≥n: Falta poste KM 23.5 (Confianza: 0.89)\n  Evidencia: Ausencia detectada por Computer Vision\n  Normativa: ADIF requiere se√±alizaci√≥n cada 500m\n  Acci√≥n: Instalaci√≥n requerida\n  \n‚ö†Ô∏è Estructura temporal no en gemelo (Confianza: 0.93)\n  Evidencia: Detectada en imagen, ausente en TWINECO\n  Acci√≥n: Actualizaci√≥n gemelo digital\n\n[REVISI√ìN HUMANA]\nRevisor: supervisor.senior@empresa.com\nComentarios: \"An√°lisis correcto. Las dos observaciones son v√°lidas y requieren acci√≥n. Prioridad media. Programar correcciones para esta semana.\"\nDecisi√≥n: APROBADO\n\n[M√âTRICAS DE CALIDAD]\nGrounding Score: 0.96\nCross-Validation Score: 0.94\nCitation Accuracy: 100%\nHuman Agreement: 100%\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENTO VALIDADO Y APROBADO PARA ACCI√ìN\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
            "metadata": {
              "fecha_analisis": "2025-10-15",
              "fecha_validacion": "2025-10-15 10:45:22",
              "tiempo_procesamiento": "13.2s",
              "tiempo_validacion_humana": "960s",
              "classification_level": "Interno",
              "validacion_automatica": {
                "grounding_score": 0.96,
                "cross_validation_score": 0.94,
                "confidence_score": 0.91,
                "citation_accuracy": 1.0
              },
              "validacion_humana": {
                "revisor": "supervisor.senior@empresa.com",
                "decision": "Aprobado",
                "human_agreement": 1.0
              },
              "hitl_required": true,
              "hitl_reason": "Safety-critical project"
            }
          }
        }
      ],
      "puntos_fuertes": [
        {
          "texto": "Grounding: toda afirmaci√≥n con evidencia documental",
          "explicacion": "Cada detecci√≥n est√° respaldada por evidencia: imagen analizada, medici√≥n DIGAV, estado previo TWINECO. No hay afirmaciones sin fundamento."
        },
        {
          "texto": "Cross-validation entre agentes",
          "explicacion": "Computer Vision detecta desviaci√≥n (confidence 0.94). Cross-Validator revisa evidencia, correlaciona con alertas previas, ajusta confidence a 0.91. Reduce falsos positivos."
        },
        {
          "texto": "Confidence scoring para decisiones",
          "explicacion": "Cada resultado tiene score 0-1. >0.85 ‚Üí auto-aprobado. 0.70-0.85 ‚Üí revisi√≥n opcional. <0.70 ‚Üí requiere humano. Decisiones basadas en certeza."
        },
        {
          "texto": "Citations completas y trazables",
          "explicacion": "Output incluye referencias: 'Desviaci√≥n 3cm [1][2] excede tolerancia 2cm [3]'. [1]=imagen, [2]=medici√≥n DIGAV, [3]=norma ADIF. Trazabilidad total."
        },
        {
          "texto": "Human-in-the-loop para baja confianza",
          "explicacion": "Si confidence < 0.85, ingeniero senior recibe notificaci√≥n con contexto completo. Puede aprobar, rechazar o solicitar m√°s informaci√≥n."
        },
        {
          "texto": "Sistema robusto y confiable",
          "explicacion": "Combinaci√≥n de especializaci√≥n, seguridad, monitorizaci√≥n y validaci√≥n. Sistema empresarial production-ready con SLA 99.9%."
        }
      ],
      "problemas": [],
      "problemas_resueltos": [
        {
          "texto": "Un solo agente sobrecargado",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No valida normativa",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "No actualiza gemelo digital",
          "explicacion": "‚úÖ Resuelto en Layer 2"
        },
        {
          "texto": "Agentes con acceso sin control",
          "explicacion": "‚úÖ Resuelto en Layer 3"
        },
        {
          "texto": "Sin m√©tricas de rendimiento",
          "explicacion": "‚úÖ Resuelto en Layer 4"
        },
        {
          "texto": "Validaci√≥n de decisiones",
          "explicacion": "Resuelto: Grounding Engine + Cross-Validator verifican cada decisi√≥n con evidencia."
        },
        {
          "texto": "Nivel de confianza en resultados",
          "explicacion": "Resuelto: Confidence Scoring cuantifica certeza. Human review para casos de baja confianza."
        }
      ]
    }
  ]
}